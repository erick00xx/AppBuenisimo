
@{
    ViewBag.Title = "RegistrarComprasExcel";
}

<h2>Registrar Compras Masivas (Excel)</h2>

@if (TempData["Exito"] != null)
{
    <div class="alert alert-success">@TempData["Exito"]</div>
}

@if (ViewBag.Errores != null)
{
    <div class="alert alert-danger">
        <strong>Errores encontrados:</strong>
        <ul>
            @foreach (var error in ViewBag.Errores as List<string>)
            {
                <li>@error</li>
            }
        </ul>
    </div>
}

<p class="alert alert-info">
    @ViewBag.MensajeFormato
    <br />
    Formato esperado: <strong>Insumo, Cantidad, Unidad, Proveedor, Sucursal, Fecha (dd/mm/yyyy)</strong>
</p>

@using (Html.BeginForm("RegistrarComprasExcel", "Abastecimiento", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    <div class="form-group">
        <label for="archivoExcel">Selecciona un archivo Excel (.xlsx)</label>
        <input type="file" name="archivoExcel" id="archivoExcel" class="form-control" required />
    </div>

    <button type="submit" class="btn btn-primary">Subir y Registrar</button>
}