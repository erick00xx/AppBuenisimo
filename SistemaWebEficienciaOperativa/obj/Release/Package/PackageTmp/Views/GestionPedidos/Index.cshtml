@model List<SistemaWebEficienciaOperativa.Models.tbPedidos>
@{
    ViewBag.Title = "Index";
}

<h2>Pedidos Activos</h2>
<br />
<div>
    @Html.ActionLink("Nuevo Pedido", "NuevoPedido", "GestionPedidos", null, new { @class = "btn btn-dark" })
</div>
<br />
@if (!Model.Any())
{
    <div class="alert alert-info">No hay pedidos activos en este momento.</div>
}
else
{
    foreach (var m in Model)
    {
        <div class="card mb-3">
            <div class="card-header">
                Mesa: <strong>@m.tbMesas.codMesa</strong> - Estado: <span class="badge badge-info">@m.tbEstadosPedidos.estado</span>
            </div>
            <div class="card-body">
                <h5 class="card-title">Pedido #@m.idPedido</h5>
                @if (m.idEstadoPedido == 1)
                {
                    <p class="card-text text-danger font-weight-bold">¡Nuevo Pedido!</p>
                }
                <p class="card-text">
                    Total: @(m.total?.ToString("C", System.Globalization.CultureInfo.GetCultureInfo("es-PE"))) <br />
                    Usuario: @(m.tbUsuarios?.nombre ?? "N/A") @(m.tbUsuarios?.apellido ?? "")
                </p>
                @Html.ActionLink("Ver Detalles", "DetallesPedido", "GestionPedidos", new { id = m.idPedido }, new { @class = "btn btn-primary" })
            </div>
            <div class="card-footer text-muted">
                Registrado: @(m.fechaPedido?.ToString("g"))
            </div>
        </div>
    }
}